import {
  Meta,
  Story,
  Preview,
  Props,
  Source
} from "@storybook/addon-docs/blocks";
import { useState } from "react";
import { action } from '@storybook/addon-actions';
import PropTypes from "prop-types";

import { storiesOf } from "@storybook/react";
import {
  withKnobs,
  select,
  text,
  number,
  boolean,
  optionsKnob as options
} from "@storybook/addon-knobs";

import { ImportPath, arrayToOptions, State } from "components/util/storybook";

import Toaster, { Toaster as RawToaster } from "components/interactive/Toaster";
import Toast from "components/interactive/Toast";

<Meta
  title="Components/Interactive/Toaster"
  decorators={[withKnobs]}
  component={Toaster}
/>

# Toaster

<ImportPath component={RawToaster} section="interactive" />

Controller for positioning, transition, and dismissal of toasts.

<Story name="Knobs">
  {() => {   
    const [isToastShowing, setIsToastShowing] = useState(false);
    return (
      <>
        <button onClick={() => setIsToastShowing(!isToastShowing)}>{isToastShowing ? 'Hide Toaster' : 'Show Toaster'}</button>
        <Toaster
          isOpen={isToastShowing}
          onDismiss={() => setIsToastShowing(false)}
          dismissDelay={number("dismissDelay", undefined)}
          dismissToast={action('dismissToast')}
          isAutoDismiss={boolean("isAutoDismiss", undefined)}
          toastProps={{
            content: text("content", "hey"),
            type: options(
              "type",
              arrayToOptions(['error', 'success', 'info', 'progress']),
              'info',
              { display: "inline-radio" }
            ),
            progress: number("progress", 42, {
              range: true,
              min: 1,
              max: 100,
              step: 1
            }),
            canDismiss: boolean("canDismiss", undefined),
            dismissOnAction: boolean("dismissOnAction", true),
            actionLabel: text("actionLabel", 'Action'),
            onAction: action('onAction')
          }}
        />
      </>
    )
  }}
</Story>

<Story name="Rendering" parameters={{ docs: { disable: true }}}>
  {() => {   
    const [isToastShowing, setIsToastShowing] = useState(false);
    const [isShadow, setIsShadow] = useState(false);
    const [currentRoute, setCurrentRoute] = useState('home')
    const [contentValue, setContentValue] = useState(null)
    const toastProps = {
      content: <p>{contentValue}</p>,
      dismissOnAction: true,
      actionLabel: 'Action',
      onAction: action('onAction')
    }
    return (
      <div className={isShadow ? "elevation--1 padding--all" : "padding--all"}>
        <button onClick={() => setIsShadow(!isShadow)}>{isShadow ? 'Hide Shadow' : 'Show Shadow'}</button>
        <button onClick={() => setIsToastShowing(!isToastShowing)}>{isToastShowing ? 'Hide Toaster' : 'Show Toaster'}</button>
        <button onClick={() => setCurrentRoute('home')}>Navigate Home</button>
        <button onClick={() => setCurrentRoute('about us')}>Navigate Home</button>
        <button onClick={() => setContentValue(contentValue === 'hello' ? 'world' : 'hello')}>Toggle content value</button>
        <button
          onClick={() => { 
            setIsToastShowing(true)
            setContentValue('blah')
          }}
        >
          Special!
        </button>
        {currentRoute === 'home' && (
          <Toaster
            isOpen={isToastShowing}
            onDismiss={() => setIsToastShowing(false)}
            isAutoDismiss={false}
            toastProps={toastProps}
          />
        )}
      </div>
    )
  }}
</Story>

<Props of={RawToaster} />

Important notes:

- **⚠️ Include only one `Toaster` component per application** to ensure that only one toast is rendered at a time.
- Anytime `content` or `type` is added or modified, the Toast will animate out, and a new Toast will take it's place. 
- Any other modified props will change the Toast in place, without triggering re-animation.
